# Migration `20200404095638-initial`

This migration has been generated by Frederick Morin at 4/4/2020, 9:56:38 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_User" (
    "committeeRecruitmentConsent" BOOLEAN NOT NULL DEFAULT false ,
    "contactPreference" TEXT NOT NULL DEFAULT 'email' ,
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "dateOfBirth" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "email" TEXT NOT NULL DEFAULT '' ,
    "firstName" TEXT NOT NULL DEFAULT '' ,
    "gender" TEXT NOT NULL DEFAULT 'male' ,
    "id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,
    "lang" INTEGER NOT NULL  ,
    "lastName" TEXT NOT NULL DEFAULT '' ,
    "location" TEXT NOT NULL DEFAULT '' ,
    "otherSkills" TEXT   ,
    "phone" TEXT   ,
    "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,FOREIGN KEY ("lang") REFERENCES "Language"("id") ON DELETE CASCADE ON UPDATE CASCADE
) 

INSERT INTO "quaint"."new_User" ("committeeRecruitmentConsent", "contactPreference", "createdAt", "dateOfBirth", "email", "firstName", "gender", "id", "lang", "lastName", "location", "otherSkills", "phone", "updatedAt") SELECT "committeeRecruitmentConsent", "contactPreference", "createdAt", "dateOfBirth", "email", "firstName", "gender", "id", "lang", "lastName", "location", "otherSkills", "phone", "updatedAt" FROM "quaint"."User"

DROP TABLE "quaint"."User";

ALTER TABLE "quaint"."new_User" RENAME TO "User";

CREATE UNIQUE INDEX "quaint"."User.email" ON "User"("email")

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;

PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."new_Skill" (
    "domain" INTEGER NOT NULL  ,
    "id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,
    "name" TEXT NOT NULL DEFAULT '' ,FOREIGN KEY ("domain") REFERENCES "SkillDomain"("id") ON DELETE CASCADE ON UPDATE CASCADE
) 

INSERT INTO "quaint"."new_Skill" ("domain", "id", "name") SELECT "domain", "id", "name" FROM "quaint"."Skill"

DROP TABLE "quaint"."Skill";

ALTER TABLE "quaint"."new_Skill" RENAME TO "Skill";

CREATE UNIQUE INDEX "quaint"."Skill.name" ON "Skill"("name")

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;

CREATE  INDEX "quaint"."_SkillDomainToUser_B_index" ON "_SkillDomainToUser"("B")

CREATE  INDEX "quaint"."_SkillToUser_B_index" ON "_SkillToUser"("B")

CREATE  INDEX "quaint"."_AvailabilityToUser_B_index" ON "_AvailabilityToUser"("B")

CREATE UNIQUE INDEX "quaint"."Language.name" ON "Language"("name")

CREATE UNIQUE INDEX "quaint"."Availability.name" ON "Availability"("name")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200404095638-initial
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,66 @@
+datasource DS {
+  provider = "sqlite"
+  url      = env("DATABASE_URL")
+}
+
+generator photonjs {
+  provider      = "prisma-client-js"
+  binaryTargets = env("BINARY_TARGET")
+}
+
+// Define your own datamodels here and run `yarn redwood db save` to create
+// migrations for them.
+
+model User {
+  id                          Int            @id @default(autoincrement())
+  createdAt                   DateTime       @default(now())
+  updatedAt                   DateTime       @updatedAt
+  firstName                   String
+  lastName                    String
+  dateOfBirth                 DateTime
+  gender                      Gender
+  lang                        Language
+  location                    String
+  phone                       String?
+  email                       String         @unique
+  contactPreference           ContactBy
+  skillDomains                SkillDomain[]
+  skills                      Skill[]
+  otherSkills                 String?
+  availabilities              Availability[]
+  committeeRecruitmentConsent Boolean        @default(false)
+}
+
+model SkillDomain {
+  id     Int     @id @default(autoincrement())
+  name   String  @unique
+  skills Skill[]
+  users  User[]
+}
+
+model Skill {
+  id     Int         @id @default(autoincrement())
+  name   String      @unique
+  domain SkillDomain
+  users  User[]
+}
+
+model Availability {
+  id    Int    @id @default(autoincrement())
+  name  String @unique
+  users User[]
+}
+
+model Language {
+  id    Int    @id @default(autoincrement())
+  name  String @unique
+  users User[]
+}
+
+enum Gender {
+  male female
+}
+
+enum ContactBy {
+  email phone text
+}
```


