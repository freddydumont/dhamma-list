# Migration `20200404112517-initial`

This migration has been generated by Frederick Morin at 4/4/2020, 11:25:17 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "Gender" AS ENUM ('male', 'female');

CREATE TYPE "ContactBy" AS ENUM ('email', 'phone', 'text');

CREATE TABLE "public"."User" (
    "committeeRecruitmentConsent" boolean  NOT NULL DEFAULT false,
    "contactPreference" "ContactBy" NOT NULL DEFAULT 'email',
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "dateOfBirth" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "email" text  NOT NULL DEFAULT '',
    "firstName" text  NOT NULL DEFAULT '',
    "gender" "Gender" NOT NULL DEFAULT 'male',
    "id" SERIAL,
    "lang" integer  NOT NULL ,
    "lastName" text  NOT NULL DEFAULT '',
    "location" text  NOT NULL DEFAULT '',
    "otherSkills" text   ,
    "phone" text   ,
    "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."SkillDomain" (
    "id" SERIAL,
    "name" text  NOT NULL DEFAULT '',
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Skill" (
    "domain" integer  NOT NULL ,
    "id" SERIAL,
    "name" text  NOT NULL DEFAULT '',
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Availability" (
    "id" SERIAL,
    "name" text  NOT NULL DEFAULT '',
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Language" (
    "id" SERIAL,
    "name" text  NOT NULL DEFAULT '',
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."_SkillDomainToUser" (
    "A" integer  NOT NULL ,
    "B" integer  NOT NULL 
) 

CREATE TABLE "public"."_SkillToUser" (
    "A" integer  NOT NULL ,
    "B" integer  NOT NULL 
) 

CREATE TABLE "public"."_AvailabilityToUser" (
    "A" integer  NOT NULL ,
    "B" integer  NOT NULL 
) 

CREATE UNIQUE INDEX "User.email" ON "public"."User"("email")

CREATE UNIQUE INDEX "SkillDomain.name" ON "public"."SkillDomain"("name")

CREATE UNIQUE INDEX "Skill.name" ON "public"."Skill"("name")

CREATE UNIQUE INDEX "Availability.name" ON "public"."Availability"("name")

CREATE UNIQUE INDEX "Language.name" ON "public"."Language"("name")

CREATE UNIQUE INDEX "_SkillDomainToUser_AB_unique" ON "public"."_SkillDomainToUser"("A","B")

CREATE  INDEX "_SkillDomainToUser_B_index" ON "public"."_SkillDomainToUser"("B")

CREATE UNIQUE INDEX "_SkillToUser_AB_unique" ON "public"."_SkillToUser"("A","B")

CREATE  INDEX "_SkillToUser_B_index" ON "public"."_SkillToUser"("B")

CREATE UNIQUE INDEX "_AvailabilityToUser_AB_unique" ON "public"."_AvailabilityToUser"("A","B")

CREATE  INDEX "_AvailabilityToUser_B_index" ON "public"."_AvailabilityToUser"("B")

ALTER TABLE "public"."User" ADD FOREIGN KEY ("lang")REFERENCES "public"."Language"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Skill" ADD FOREIGN KEY ("domain")REFERENCES "public"."SkillDomain"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_SkillDomainToUser" ADD FOREIGN KEY ("A")REFERENCES "public"."SkillDomain"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_SkillDomainToUser" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_SkillToUser" ADD FOREIGN KEY ("A")REFERENCES "public"."Skill"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_SkillToUser" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_AvailabilityToUser" ADD FOREIGN KEY ("A")REFERENCES "public"."Availability"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_AvailabilityToUser" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200404112517-initial
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,66 @@
+datasource DS {
+  provider = "postgresql"
+  url      = env("DATABASE_URL")
+}
+
+generator photonjs {
+  provider      = "prisma-client-js"
+  binaryTargets = env("BINARY_TARGET")
+}
+
+// Define your own datamodels here and run `yarn redwood db save` to create
+// migrations for them.
+
+model User {
+  id                          Int            @id @default(autoincrement())
+  createdAt                   DateTime       @default(now())
+  updatedAt                   DateTime       @updatedAt
+  firstName                   String
+  lastName                    String
+  dateOfBirth                 DateTime
+  gender                      Gender
+  lang                        Language
+  location                    String
+  phone                       String?
+  email                       String         @unique
+  contactPreference           ContactBy
+  skillDomains                SkillDomain[]
+  skills                      Skill[]
+  otherSkills                 String?
+  availabilities              Availability[]
+  committeeRecruitmentConsent Boolean        @default(false)
+}
+
+model SkillDomain {
+  id     Int     @id @default(autoincrement())
+  name   String  @unique
+  skills Skill[]
+  users  User[]
+}
+
+model Skill {
+  id     Int         @id @default(autoincrement())
+  name   String      @unique
+  domain SkillDomain
+  users  User[]
+}
+
+model Availability {
+  id    Int    @id @default(autoincrement())
+  name  String @unique
+  users User[]
+}
+
+model Language {
+  id    Int    @id @default(autoincrement())
+  name  String @unique
+  users User[]
+}
+
+enum Gender {
+  male female
+}
+
+enum ContactBy {
+  email phone text
+}
```


